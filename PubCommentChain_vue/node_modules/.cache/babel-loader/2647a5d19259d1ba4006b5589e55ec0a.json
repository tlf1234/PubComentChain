{"remainingRequest":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\babel-loader\\lib\\index.js!D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pubComentsChain\\PubCommentChain_vue\\src\\views\\cinema\\Cinema.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\src\\views\\cinema\\Cinema.vue","mtime":1569206673000},{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645264055207},{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1529635966000},{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  data: function data() {\n    return {\n      uname: '',\n      active: 2,\n      iTem: 0,\n      //临时保存i的值\n      i: 0,\n      //那张图片变大\n      marginLeft: window.innerWidth * 0.39,\n      // 22vw一个位移 ,保存了ul的margin-left值\n      xStart: \"\",\n      //保存了初始手指位置\n      mlStart: \"\",\n      //保存ul初始位置\n      movie: [],\n      time: [],\n      ulWidth: '400vw',\n      wiw: window.innerWidth,\n      cinema: [],\n      tag: []\n    };\n  },\n  watch: {\n    //监听i;\n    // i(){\n    //   this.iCenter();\n    // },\n    //监听marginLeft;\n    marginLeft: function marginLeft() {\n      //2 对marginLeft进行控制\n      var mlEnd = this.marginLeft; //3 获取移动结束的margin-left值\n      //4 下面动态改变i的值      \n\n      var ml = this.marginLeft; //\n\n      ml = window.innerWidth * 0.50 - ml; //用来计算向左移动多少margin-left\n\n      var i = parseInt(ml / (window.innerWidth * 0.22)); // console.log(ml);\n\n      if (i > this.movie.length - 1) {\n        i = this.movie.length - 1;\n      }\n\n      if (i < 0) {\n        i = 0;\n      }\n\n      this.i = i; // console.log(i);\n      //5 ml当前的margin-left;中心的margin-left;\n\n      var mlCenter = -window.innerWidth * 0.22 * this.i + window.innerWidth * 0.39; //i图片中心的margin-left;\n      // 6 获取最大的abs差值\n\n      var wiw = this.wiw;\n      var absMax = wiw * 0.11;\n      var absWid = Math.abs(mlEnd - mlCenter); //7 比例\n\n      var scale = 1 - absWid / absMax; // console.log(scale);\n\n      var imgBlock = document.getElementsByClassName(\"activeImg\")[0];\n      var imgBlockNo = document.getElementsByClassName(\"noActive\"); //使其他归位\n\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = imgBlockNo[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var item = _step.value;\n          item.style.width = '';\n          item.style.height = '';\n          item.style.left = '10%';\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      imgBlock.style.width = (17.6 + 3.3 * scale) * wiw * 0.01 + 'px';\n      imgBlock.style.height = (24.3 + 4.5 * scale) * wiw * 0.01 + 'px';\n      imgBlock.style.left = 2.5 + 7.5 * (1 - scale) + '%';\n    }\n  },\n  computed: {\n    url: function url() {\n      return this.$store.state.url;\n    },\n    //使用计算属性，动态返回图片的路径\n    imgUrls: function imgUrls() {\n      if (this.movie.length == 0) {\n        return null; //页面刷新时返回null\n      } else {\n        return \"http://127.0.0.1:5050/\".concat(this.movie[this.i].pic);\n      }\n    },\n    //ul的宽度\n    cid: function cid() {\n      return this.$store.state.cid;\n    },\n    //获取cid\n    mid: function mid() {\n      return this.$store.state.mid;\n    }\n  },\n  created: function created() {\n    //调用axios函数\n    console.log(this.$route.path);\n    console.log(window.location.href);\n    this.loadCinema();\n    this.isLogin();\n  },\n  mounted: function mounted() {\n    this.loadMore();\n    this.wait();\n  },\n  methods: {\n    //跳转到seat.vue\n    goSeat: function goSeat(e) {\n      var _this = this;\n\n      var cmid = e.currentTarget.dataset.cmid;\n      var uid = this.$store.getters.getUid; //1 如果登录了，跳转到seat.vue\n\n      if (uid != \"\") {\n        this.$store.commit(\"changeCmid\", cmid);\n        this.$router.push(\"/seat\");\n      } else {\n        //2 如果没登录,先登录，在跳转\n        this.$messagebox.confirm(\"是否立即登录\").then(function (action) {\n          _this.$router.push('/login');\n        }).catch(function (err) {\n          return;\n        });\n      }\n    },\n    //1 跳转到登录页，保存住当前页面的地址\n    toLogin: function toLogin() {\n      this.$router.push(\"/login\");\n    },\n    //2 判断是否登录\n    isLogin: function isLogin() {\n      var _this2 = this;\n\n      var url = \"user/v1/isLogin\";\n      this.axios.get(url).then(function (res) {\n        if (res.data.code == -1) {\n          console.log(res.data.msg);\n        } else {\n          //登录成功，保存住uname;\n          console.log(\"打印用户登录信息\", res.data.data[0]);\n          _this2.uname = res.data.data[0].uname;\n        }\n      });\n    },\n    //获取今天的时间和明天的时间\n    getDay: function getDay(num) {\n      var d2 = new Date();\n      d2 = d2.getTime();\n      d2 += num * 24 * 60 * 60 * 1000; //以d2毫秒数为基础\n\n      var d1 = new Date(d2);\n      var month = d1.getMonth();\n      month = month >= 9 ? month + 1 : \"0\" + (month + 1);\n      var date = d1.getDate();\n      date = date >= 10 ? date : '0' + date;\n      return month + \"-\" + date;\n    },\n    //1 动态计算那部电影会居中显示\n    showI: function showI() {\n      for (var i = 0; i < this.movie.length; i++) {\n        if (this.movie[i].mid == this.mid) {\n          this.iTem = i; //获取真实的mid对应的下标\n\n          return;\n        }\n      }\n    },\n    //页面刷新，等待500执行\n    wait: function wait() {\n      var _this3 = this;\n\n      setTimeout(function () {\n        _this3.i = _this3.iTem;\n        setTimeout(function () {\n          _this3.iCenter();\n        }, 100);\n      }, 300);\n    },\n    //i位置的图片居中函数\n    iCenter: function iCenter() {\n      var ml = -window.innerWidth * 0.22 * this.i + window.innerWidth * 0.39;\n      this.marginLeft = ml;\n      var wiw = this.wiw;\n      var imgBlock = document.getElementsByClassName(\"activeImg\")[0];\n      imgBlock.style.width = 20.9 * wiw * 0.01 + 'px';\n      imgBlock.style.height = 28.8 * wiw * 0.01 + 'px';\n      imgBlock.style.left = '2.5%';\n    },\n    //切割字符串的icon的函数\n    strSplit: function strSplit(str) {\n      var arr = str.split(\"，\"); // console.log(arr)\n\n      return arr;\n    },\n    //点击图片时移动,改变i值和margin-left值\n    changeI: function changeI(e) {\n      var i = e.target.dataset.index;\n      var ml = -window.innerWidth * 0.22 * i + window.innerWidth * 0.39;\n      this.i = i;\n      this.marginLeft = ml;\n      var wiw = this.wiw; //设置定时器，在i值改变时，50ms后准确的捕捉到元素   \n\n      setTimeout(function () {\n        var imgBlockNo = document.getElementsByClassName(\"noActive\"); // console.log(imgBlockNo)\n\n        var _iteratorNormalCompletion2 = true;\n        var _didIteratorError2 = false;\n        var _iteratorError2 = undefined;\n\n        try {\n          for (var _iterator2 = imgBlockNo[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n            var item = _step2.value;\n            item.style.width = 17.6 * wiw * 0.01 + 'px';\n            ;\n            item.style.height = 24.3 * wiw * 0.01 + 'px';\n            ;\n            item.style.left = '10%';\n          } //使点击的图片居中\n\n        } catch (err) {\n          _didIteratorError2 = true;\n          _iteratorError2 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n              _iterator2.return();\n            }\n          } finally {\n            if (_didIteratorError2) {\n              throw _iteratorError2;\n            }\n          }\n        }\n\n        var imgBlock = e.target.parentNode; // var imgBlock=document.getElementsByClassName(\"activeImg\")[0]\n\n        imgBlock.style.width = 20.9 * wiw * 0.01 + 'px';\n        imgBlock.style.height = 28.8 * wiw * 0.01 + 'px';\n        imgBlock.style.left = \"2.5%\"; //使其他图片归位\n      }, 50);\n    },\n    //鼠标松开时，使下标i的图片居中\n    ontouchend: function ontouchend() {\n      this.iCenter(); // var ml=-window.innerWidth*0.22*(this.i)+window.innerWidth*0.39;\n      // this.marginLeft=ml; \n      // var wiw=this.wiw;\n      // var imgBlock=document.getElementsByClassName(\"activeImg\")[0]\n      // imgBlock.style.width=20.9*wiw*0.01+'px';\n      // imgBlock.style.height=28.8*wiw*0.01+'px';\n      // imgBlock.style.left='2.5%';\n    },\n    //点击时保存鼠标初始位置，和ul的起始位置\n    ontouchstart: function ontouchstart(e) {\n      var t1 = e.targetTouches[0];\n      this.xStart = t1.pageX;\n      this.mlStart = this.marginLeft;\n    },\n    //鼠标移动时，改变ul的margin-left;\n    ontouchmove: function ontouchmove(e) {\n      var t2 = e.targetTouches[0];\n      var xMove = t2.pageX; //鼠标移动后的位置\n\n      var move = xMove - this.xStart; //鼠标移动的距离=ul移动的距离        ;\n\n      var marginLeft = this.mlStart + move; //1 防止到最右边和最左边\n\n      var widthMin = window.innerWidth * 0.39;\n\n      if (marginLeft >= widthMin) {\n        marginLeft = widthMin;\n      }\n\n      var widthMax = window.innerWidth * 0.39 - window.innerWidth * 0.22 * (this.movie.length - 1);\n\n      if (marginLeft <= widthMax) {\n        marginLeft = widthMax;\n      }\n\n      this.marginLeft = marginLeft;\n    },\n    //ajax函数   参数cid\n    loadMore: function loadMore() {\n      var _this4 = this;\n\n      var url = \"cinema/v1/cinema_hasmovies\";\n      var obj = {\n        cid: this.cid\n      };\n      this.axios.get(url, {\n        params: obj\n      }).then(function (res) {\n        if (res.data.code == 1) {\n          console.log(res.data.data);\n          _this4.movie = res.data.data.infors;\n          _this4.time = res.data.data.times; //后台传回mid\n          // var mid=this.$store.getMid();\n          // console.log(this.mname);\n\n          console.log(_this4.movie);\n\n          _this4.showI();\n\n          _this4.ulWidth = _this4.movie.length * window.innerWidth * 0.22 + 'px'; // console.log(\"axios查询成功\")\n        } else {\n          console.log(\"axios查询失败1\");\n        }\n      });\n    },\n    loadCinema: function loadCinema() {\n      var _this5 = this;\n\n      var url = \"cinema/v1/cinema_detail\";\n      var obj = {\n        cid: this.cid\n      };\n      this.axios.get(url, {\n        params: obj\n      }).then(function (res) {\n        if (res.data.code == 1) {\n          console.log(res.data.data[0]);\n          _this5.cinema = res.data.data[0];\n          _this5.tag = _this5.strSplit(_this5.cinema.tag); // console.log(\"axios查询成功\")\n        } else {\n          console.log(\"axios查询失败2\");\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["Cinema.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div id=\"cinema_show\" v-cloak>\n    <!-- load-wait 组件 -->\n    <my-load-wait></my-load-wait>\n    <!--1 头部 ： 影院详情 -->\n    <div class=\"cinema_top\">\n      <div class=\"title\">{{cinema.cname}}</div>\n      <div class=\"address\">{{cinema.caddress}}}</div>\n      <div class=\"icons cf\">\n        <div class=\"icon\" v-for=\"(elem,i) of tag\" :key=\"i\">{{elem}}</div>\n        <!-- <div class=\"icon\">观影小食</div>\n        <div class=\"icon\">可停车</div> -->\n      </div>\n      <div class=\"prefe\">\n        <span>联合优惠专区</span> <br>\n        <span>银行、运营商特惠</span>\n      </div>\n      <div class=\"icon_abs\">\n        <img class=\"map\" src=\"http://127.0.0.1:5050/icon/dingwei.svg\" alt=\"\">\n        <img class=\"collect\" src=\"http://127.0.0.1:5050/icon/collect.svg\" alt=\"\">\n      </div>\n\n    </div>\n    <!--2 头部 ： 电影图片 -->\n    <div class=\"cinema_middle_img\" @touchstart=\"ontouchstart\" @touchmove=\"ontouchmove\" @touchend=\"ontouchend\">\n      <div class=\"img_blur\">\n        <img :src=\"imgUrls\" alt=\"\">\n      </div>\n      <div class=\"ul_cover\"></div>\n      <ul class=\"img_ul cf\" :style=\"{marginLeft:marginLeft+'px',width:ulWidth}\">\n        <li class=\"img_li\" v-for=\"(item,index) of movie\" :key=\"index\"> \n          <div class=\"img_block\" :class=\"{activeImg:index==i,noActive:index!=i}\">\n            <img   :src=\"`http://127.0.0.1:5050/${item.pic}`\" alt=\"\">\n            <router-link :to=\"'/movieDetail/'+item.mid\"></router-link>\n            <!-- <a href=\"\"></a> -->\n            <div class=\"cover\" :data-index=\"index\" :class=\"{active:index==i}\" @click=\"changeI\" ></div>\n          </div>\n        </li>\n      </ul>\n    </div>\n    <!-- 简介部分 -->\n    <div class=\"cinema_middle_title\" v-for=\"(item,index) of movie\" :key=\"index\" :class=\"{'d-none':index!=i}\">\n      <span class=\"title\">{{item.mname}}</span>\n      <span class=\"show\" :class=\"{'d-none':item.is_show==0}\">\n        <span class=\"ping\">淘票票评分</span>\n        <span class=\"score\">{{item.score}}</span>\n      </span>\n      <span class=\"show\"  :class=\"{'d-none':item.is_show==1}\">\n        <span class=\"people\">{{item.wish}}</span>\n        <span class=\"want\">人想看</span>\n      </span>\n      <br>\n      <span class=\"infor\">{{item.infor}}</span>\n    </div>\n    <!--3 头部 ： 电影播放时间 -->\n    <div class=\"cinema_bottom\" >\n      <van-tabs v-model=\"active\" line-width='5.3vw' color=\"#ff2e62\" line-height=\"2px\" title-active-color=\"#ff2e62\" v-for=\"(item,index) of time\" :key=\"index\" v-show=\"index==i\">\n        <van-tab :title=\"'今天'+getDay(0)\">\n          <div class=\"noPlay\" v-show=\"item[0].room==''\">今天{{getDay(0)}}暂无场次</div>\n          <div class=\"time_item\" v-show=\"item[0].room!=''\" v-for=\"(elem,j) of item\" :key=\"j\">\n            <div class=\"item1\">\n              <div>{{elem.time_start}}</div>\n              <div>{{elem.time_end}}散场</div>\n            </div>\n            <div class=\"item2\">\n              <div>{{elem.d23}}</div>\n              <div>{{elem.room}}</div>\n            </div>\n            <div class=\"item3\">\n              <div><span>{{elem.price_e}}</span><span> 元</span></div>\n              <div>{{elem.price_s}}元</div>\n            </div>\n            <div class=\"item4\">\n              <div @click=\"goSeat\" :data-cmid=\"elem.cmid\">购票</div>\n            </div>\n          </div>\n        </van-tab>\n        <van-tab :title=\"'明天'+getDay(1)\">\n          <div class=\"noPlay\" v-show=\"item[0].room==''\">明天{{getDay(1)}}暂无场次</div>\n          <div class=\"time_item\" v-show=\"item[0].room!=''\" v-for=\"(elem,j) of item\" :key=\"j\">\n            <div class=\"item1\">\n              <div>{{elem.time_start}}</div>\n              <div>{{elem.time_end}}散场</div>\n            </div>\n            <div class=\"item2\">\n              <div>{{elem.d23}}</div>\n              <div>{{elem.room}}</div>\n            </div>\n            <div class=\"item3\">\n              <div><span>{{elem.price_e}}</span><span> 元</span></div>\n              <div>{{elem.price_s}}元</div>\n            </div>\n            <div class=\"item4\">\n              <div @click=\"goSeat\" :data-cmid=\"elem.cmid\">购票</div>\n            </div>\n          </div>\n        </van-tab>\n      </van-tabs>\n    </div>\n    <!-- 4 尾部 ： 淘票票图标 -->\n    <div class=\"cinema_floor\">\n      <img :src=\"url+'cinema/moive_floor.svg'\" alt=\"\">\n    </div>\n    <!-- 5 为登录弹框 -->\n    <div class=\"cinema_login\" v-show=\"uname==''\" @click=\"toLogin\">\n      <div>请先登录再购买电影票</div>\n      <div>登录</div>\n    </div>\n  </div>\n</template>\n<script>\nexport default {\n  data(){\n    return {\n      uname:'',\n      active: 2,\n      iTem:0,     //临时保存i的值\n      i:0,        //那张图片变大\n      marginLeft:window.innerWidth*0.39,  // 22vw一个位移 ,保存了ul的margin-left值\n      xStart:\"\",  //保存了初始手指位置\n      mlStart:\"\", //保存ul初始位置\n      movie:[],\n      time:[],\n      ulWidth:'400vw',\n      wiw:window.innerWidth,\n      cinema:[],\n      tag:[],\n    }\n  },\n  watch:{\n    //监听i;\n    // i(){\n    //   this.iCenter();\n    // },\n    //监听marginLeft;\n    marginLeft(){\n      //2 对marginLeft进行控制\n      var mlEnd=this.marginLeft;    //3 获取移动结束的margin-left值\n      //4 下面动态改变i的值      \n      var ml=this.marginLeft;\n      //\n      ml=window.innerWidth*0.50-ml; //用来计算向左移动多少margin-left\n      var i=parseInt(ml/(window.innerWidth*0.22)) ;\n      // console.log(ml);\n      if(i>this.movie.length-1){\n        i=this.movie.length-1\n      }\n      if(i<0){ i=0; }\n      this.i=i;\n      // console.log(i);\n      //5 ml当前的margin-left;中心的margin-left;\n      var mlCenter=-window.innerWidth*0.22*(this.i)+window.innerWidth*0.39;  //i图片中心的margin-left;\n      // 6 获取最大的abs差值\n      var wiw=this.wiw;\n      var absMax=wiw*0.11;\n      var absWid=Math.abs(mlEnd-mlCenter)\n      //7 比例\n      var scale=1-absWid/absMax;\n      // console.log(scale);\n      var imgBlock=document.getElementsByClassName(\"activeImg\")[0]\n      var imgBlockNo=document.getElementsByClassName(\"noActive\");\n      //使其他归位\n      for(var item of imgBlockNo){\n        item.style.width='';\n        item.style.height='';\n        item.style.left='10%';\n      }\n      imgBlock.style.width=(17.6+3.3*scale)*wiw*0.01+'px';\n      imgBlock.style.height=(24.3+4.5*scale)*wiw*0.01+'px';\n      imgBlock.style.left=(2.5+7.5*(1-scale))+'%';\n    },\n  },\n  computed:{\n    url(){\n      return this.$store.state.url;\n    },\n    //使用计算属性，动态返回图片的路径\n    imgUrls(){\n      if(this.movie.length==0){ \n        return null;   //页面刷新时返回null\n      }else{\n        return  `http://127.0.0.1:5050/${this.movie[this.i].pic}`\n      }\n    },\n    //ul的宽度\n    cid(){ return this.$store.state.cid;  },  //获取cid\n    mid(){ return this.$store.state.mid;  }  , //获取mid\n    // mname(){ return this.$store.state.mname; }   //获取mid\n  },\n  created(){\n    //调用axios函数\n    console.log(this.$route.path)\n    console.log(window.location.href)\n    this.loadCinema();\n    this.isLogin();\n  },\n  mounted(){      \n    this.loadMore();   \n    this.wait();\n  },\n  methods:{\n    //跳转到seat.vue\n    goSeat(e){\n      var cmid=e.currentTarget.dataset.cmid;\n      var uid=this.$store.getters.getUid;\n      //1 如果登录了，跳转到seat.vue\n      if(uid!=\"\"){\n        this.$store.commit(\"changeCmid\",cmid);\n        this.$router.push(`/seat`);\n      }else{\n        //2 如果没登录,先登录，在跳转\n        this.$messagebox.confirm(\"是否立即登录\")\n        .then(action=>{\n          this.$router.push('/login')\n        })\n        .catch(err=>{return;})\n      }\n    },\n    //1 跳转到登录页，保存住当前页面的地址\n    toLogin(){\n      this.$router.push(\"/login\")\n    },\n    //2 判断是否登录\n    isLogin(){\n      var url=\"user/v1/isLogin\";\n      this.axios.get(url).then(res=>{\n        if(res.data.code==-1){\n          console.log(res.data.msg);\n        }else{\n          //登录成功，保存住uname;\n          console.log(\"打印用户登录信息\",res.data.data[0]);\n          this.uname=res.data.data[0].uname;\n        }\n      })\n    },\n    //获取今天的时间和明天的时间\n    getDay(num){\n      var d2=new Date();\n      d2=d2.getTime();\n      d2+=num*24*60*60*1000;\n      //以d2毫秒数为基础\n      var d1=new Date(d2);\n      var month=d1.getMonth();\n      month= (month>=9) ? month+1 : (\"0\"+(month+1))\n      var date=d1.getDate();\n      date=(date>=10) ? date : ('0'+date);\n      return month+\"-\"+date;\n    },\n    //1 动态计算那部电影会居中显示\n    showI(){\n      for(var i=0;i<this.movie.length;i++){\n        if(this.movie[i].mid==this.mid){\n          this.iTem=i;  //获取真实的mid对应的下标\n          return;\n        }\n      }      \n    },\n    //页面刷新，等待500执行\n    wait(){\n      setTimeout(()=>{\n        this.i=this.iTem;\n        setTimeout(()=>{\n          this.iCenter();          \n        },100)\n\n      },300)\n    },\n    //i位置的图片居中函数\n    iCenter(){\n      var ml=-window.innerWidth*0.22*(this.i)+window.innerWidth*0.39;\n      this.marginLeft=ml; \n      var wiw=this.wiw;\n      var imgBlock=document.getElementsByClassName(\"activeImg\")[0]\n      imgBlock.style.width=20.9*wiw*0.01+'px';\n      imgBlock.style.height=28.8*wiw*0.01+'px';\n      imgBlock.style.left='2.5%';\n    },\n    //切割字符串的icon的函数\n    strSplit(str){\n      var arr=str.split(\"，\");\n      // console.log(arr)\n      return arr;\n    },\n    //点击图片时移动,改变i值和margin-left值\n    changeI(e){\n      var i=e.target.dataset.index;\n      var ml=-window.innerWidth*0.22*i+window.innerWidth*0.39;\n      this.i=i;\n      this.marginLeft=ml;\n      var wiw=this.wiw;\n      //设置定时器，在i值改变时，50ms后准确的捕捉到元素   \n      setTimeout(()=>{     \n        var imgBlockNo=document.getElementsByClassName(\"noActive\");\n        // console.log(imgBlockNo)\n        for(var item of imgBlockNo){\n          item.style.width=17.6*wiw*0.01+'px';;\n          item.style.height=24.3*wiw*0.01+'px';;\n          item.style.left='10%';\n        }     \n        //使点击的图片居中\n        var imgBlock=e.target.parentNode;\n        // var imgBlock=document.getElementsByClassName(\"activeImg\")[0]\n        imgBlock.style.width=20.9*wiw*0.01+'px';\n        imgBlock.style.height=28.8*wiw*0.01+'px';\n        imgBlock.style.left=\"2.5%\";\n        //使其他图片归位\n      },50)\n    },\n    //鼠标松开时，使下标i的图片居中\n    ontouchend(){\n      this.iCenter();\n      // var ml=-window.innerWidth*0.22*(this.i)+window.innerWidth*0.39;\n      // this.marginLeft=ml; \n      // var wiw=this.wiw;\n      // var imgBlock=document.getElementsByClassName(\"activeImg\")[0]\n      // imgBlock.style.width=20.9*wiw*0.01+'px';\n      // imgBlock.style.height=28.8*wiw*0.01+'px';\n      // imgBlock.style.left='2.5%';\n    },\n    //点击时保存鼠标初始位置，和ul的起始位置\n    ontouchstart(e){\n      var t1 = e.targetTouches[0];\n      this.xStart=t1.pageX;   \n      this.mlStart=this.marginLeft;  \n    },\n    //鼠标移动时，改变ul的margin-left;\n    ontouchmove(e){\n      var t2 = e.targetTouches[0];\n      var xMove=t2.pageX;                 //鼠标移动后的位置\n      var move=xMove-this.xStart;         //鼠标移动的距离=ul移动的距离        ;\n      var marginLeft=this.mlStart+move;\n      //1 防止到最右边和最左边\n      var widthMin=window.innerWidth*0.39;\n      if(marginLeft>=widthMin){\n        marginLeft=widthMin;\n      }\n      var widthMax=window.innerWidth*0.39-window.innerWidth*0.22*(this.movie.length-1)\n      if(marginLeft<=widthMax){\n        marginLeft=widthMax;\n      }\n      this.marginLeft=marginLeft;      \n    },\n    //ajax函数   参数cid\n    loadMore(){ \n      var url=\"cinema/v1/cinema_hasmovies\";\n      var obj={cid:this.cid};\n      this.axios.get(url,{params:obj}).then(res=>{\n        if(res.data.code==1){\n          console.log(res.data.data)\n          this.movie=res.data.data.infors;\n          this.time=res.data.data.times;\n          //后台传回mid\n          // var mid=this.$store.getMid();\n          // console.log(this.mname);\n          console.log(this.movie);\n          this.showI();\n          this.ulWidth=this.movie.length*window.innerWidth*0.22+'px'\n          // console.log(\"axios查询成功\")\n        }else{\n          console.log(\"axios查询失败1\")\n        }\n      })\n    },\n    loadCinema(){ \n      var url=\"cinema/v1/cinema_detail\";\n      var obj={cid:this.cid};\n      this.axios.get(url,{params:obj}).then(res=>{\n        if(res.data.code==1){\n          console.log(res.data.data[0])\n          this.cinema=res.data.data[0];\n          this.tag=this.strSplit(this.cinema.tag);\n          // console.log(\"axios查询成功\")\n        }else{\n          console.log(\"axios查询失败2\")\n        }\n      })\n    },\n  }\n}\n</script>\n<style>\n    @import url('../../assets/css/findCinemaItem.css');\n    @import url('../../assets/css/cinema.css')\n</style>\n"],"sourceRoot":"src\\views\\cinema"}]}