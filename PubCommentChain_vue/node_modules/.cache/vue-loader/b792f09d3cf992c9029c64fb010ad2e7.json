{"remainingRequest":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pubComentsChain\\PubCommentChain_vue\\src\\views\\cinema\\Cinema.vue?vue&type=style&index=0&lang=css","dependencies":[{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\src\\views\\cinema\\Cinema.vue","mtime":1569206673000},{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1521907989000},{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645264055207},{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import url('../../assets/css/findCinemaItem.css');\n@import url('../../assets/css/cinema.css')\n",{"version":3,"sources":["Cinema.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6XA;AACA","file":"Cinema.vue","sourceRoot":"src\\views\\cinema","sourcesContent":["<template>\n  <div id=\"cinema_show\" v-cloak>\n    <!-- load-wait 组件 -->\n    <my-load-wait></my-load-wait>\n    <!--1 头部 ： 影院详情 -->\n    <div class=\"cinema_top\">\n      <div class=\"title\">{{cinema.cname}}</div>\n      <div class=\"address\">{{cinema.caddress}}}</div>\n      <div class=\"icons cf\">\n        <div class=\"icon\" v-for=\"(elem,i) of tag\" :key=\"i\">{{elem}}</div>\n        <!-- <div class=\"icon\">观影小食</div>\n        <div class=\"icon\">可停车</div> -->\n      </div>\n      <div class=\"prefe\">\n        <span>联合优惠专区</span> <br>\n        <span>银行、运营商特惠</span>\n      </div>\n      <div class=\"icon_abs\">\n        <img class=\"map\" src=\"http://127.0.0.1:5050/icon/dingwei.svg\" alt=\"\">\n        <img class=\"collect\" src=\"http://127.0.0.1:5050/icon/collect.svg\" alt=\"\">\n      </div>\n\n    </div>\n    <!--2 头部 ： 电影图片 -->\n    <div class=\"cinema_middle_img\" @touchstart=\"ontouchstart\" @touchmove=\"ontouchmove\" @touchend=\"ontouchend\">\n      <div class=\"img_blur\">\n        <img :src=\"imgUrls\" alt=\"\">\n      </div>\n      <div class=\"ul_cover\"></div>\n      <ul class=\"img_ul cf\" :style=\"{marginLeft:marginLeft+'px',width:ulWidth}\">\n        <li class=\"img_li\" v-for=\"(item,index) of movie\" :key=\"index\"> \n          <div class=\"img_block\" :class=\"{activeImg:index==i,noActive:index!=i}\">\n            <img   :src=\"`http://127.0.0.1:5050/${item.pic}`\" alt=\"\">\n            <router-link :to=\"'/movieDetail/'+item.mid\"></router-link>\n            <!-- <a href=\"\"></a> -->\n            <div class=\"cover\" :data-index=\"index\" :class=\"{active:index==i}\" @click=\"changeI\" ></div>\n          </div>\n        </li>\n      </ul>\n    </div>\n    <!-- 简介部分 -->\n    <div class=\"cinema_middle_title\" v-for=\"(item,index) of movie\" :key=\"index\" :class=\"{'d-none':index!=i}\">\n      <span class=\"title\">{{item.mname}}</span>\n      <span class=\"show\" :class=\"{'d-none':item.is_show==0}\">\n        <span class=\"ping\">淘票票评分</span>\n        <span class=\"score\">{{item.score}}</span>\n      </span>\n      <span class=\"show\"  :class=\"{'d-none':item.is_show==1}\">\n        <span class=\"people\">{{item.wish}}</span>\n        <span class=\"want\">人想看</span>\n      </span>\n      <br>\n      <span class=\"infor\">{{item.infor}}</span>\n    </div>\n    <!--3 头部 ： 电影播放时间 -->\n    <div class=\"cinema_bottom\" >\n      <van-tabs v-model=\"active\" line-width='5.3vw' color=\"#ff2e62\" line-height=\"2px\" title-active-color=\"#ff2e62\" v-for=\"(item,index) of time\" :key=\"index\" v-show=\"index==i\">\n        <van-tab :title=\"'今天'+getDay(0)\">\n          <div class=\"noPlay\" v-show=\"item[0].room==''\">今天{{getDay(0)}}暂无场次</div>\n          <div class=\"time_item\" v-show=\"item[0].room!=''\" v-for=\"(elem,j) of item\" :key=\"j\">\n            <div class=\"item1\">\n              <div>{{elem.time_start}}</div>\n              <div>{{elem.time_end}}散场</div>\n            </div>\n            <div class=\"item2\">\n              <div>{{elem.d23}}</div>\n              <div>{{elem.room}}</div>\n            </div>\n            <div class=\"item3\">\n              <div><span>{{elem.price_e}}</span><span> 元</span></div>\n              <div>{{elem.price_s}}元</div>\n            </div>\n            <div class=\"item4\">\n              <div @click=\"goSeat\" :data-cmid=\"elem.cmid\">购票</div>\n            </div>\n          </div>\n        </van-tab>\n        <van-tab :title=\"'明天'+getDay(1)\">\n          <div class=\"noPlay\" v-show=\"item[0].room==''\">明天{{getDay(1)}}暂无场次</div>\n          <div class=\"time_item\" v-show=\"item[0].room!=''\" v-for=\"(elem,j) of item\" :key=\"j\">\n            <div class=\"item1\">\n              <div>{{elem.time_start}}</div>\n              <div>{{elem.time_end}}散场</div>\n            </div>\n            <div class=\"item2\">\n              <div>{{elem.d23}}</div>\n              <div>{{elem.room}}</div>\n            </div>\n            <div class=\"item3\">\n              <div><span>{{elem.price_e}}</span><span> 元</span></div>\n              <div>{{elem.price_s}}元</div>\n            </div>\n            <div class=\"item4\">\n              <div @click=\"goSeat\" :data-cmid=\"elem.cmid\">购票</div>\n            </div>\n          </div>\n        </van-tab>\n      </van-tabs>\n    </div>\n    <!-- 4 尾部 ： 淘票票图标 -->\n    <div class=\"cinema_floor\">\n      <img :src=\"url+'cinema/moive_floor.svg'\" alt=\"\">\n    </div>\n    <!-- 5 为登录弹框 -->\n    <div class=\"cinema_login\" v-show=\"uname==''\" @click=\"toLogin\">\n      <div>请先登录再购买电影票</div>\n      <div>登录</div>\n    </div>\n  </div>\n</template>\n<script>\nexport default {\n  data(){\n    return {\n      uname:'',\n      active: 2,\n      iTem:0,     //临时保存i的值\n      i:0,        //那张图片变大\n      marginLeft:window.innerWidth*0.39,  // 22vw一个位移 ,保存了ul的margin-left值\n      xStart:\"\",  //保存了初始手指位置\n      mlStart:\"\", //保存ul初始位置\n      movie:[],\n      time:[],\n      ulWidth:'400vw',\n      wiw:window.innerWidth,\n      cinema:[],\n      tag:[],\n    }\n  },\n  watch:{\n    //监听i;\n    // i(){\n    //   this.iCenter();\n    // },\n    //监听marginLeft;\n    marginLeft(){\n      //2 对marginLeft进行控制\n      var mlEnd=this.marginLeft;    //3 获取移动结束的margin-left值\n      //4 下面动态改变i的值      \n      var ml=this.marginLeft;\n      //\n      ml=window.innerWidth*0.50-ml; //用来计算向左移动多少margin-left\n      var i=parseInt(ml/(window.innerWidth*0.22)) ;\n      // console.log(ml);\n      if(i>this.movie.length-1){\n        i=this.movie.length-1\n      }\n      if(i<0){ i=0; }\n      this.i=i;\n      // console.log(i);\n      //5 ml当前的margin-left;中心的margin-left;\n      var mlCenter=-window.innerWidth*0.22*(this.i)+window.innerWidth*0.39;  //i图片中心的margin-left;\n      // 6 获取最大的abs差值\n      var wiw=this.wiw;\n      var absMax=wiw*0.11;\n      var absWid=Math.abs(mlEnd-mlCenter)\n      //7 比例\n      var scale=1-absWid/absMax;\n      // console.log(scale);\n      var imgBlock=document.getElementsByClassName(\"activeImg\")[0]\n      var imgBlockNo=document.getElementsByClassName(\"noActive\");\n      //使其他归位\n      for(var item of imgBlockNo){\n        item.style.width='';\n        item.style.height='';\n        item.style.left='10%';\n      }\n      imgBlock.style.width=(17.6+3.3*scale)*wiw*0.01+'px';\n      imgBlock.style.height=(24.3+4.5*scale)*wiw*0.01+'px';\n      imgBlock.style.left=(2.5+7.5*(1-scale))+'%';\n    },\n  },\n  computed:{\n    url(){\n      return this.$store.state.url;\n    },\n    //使用计算属性，动态返回图片的路径\n    imgUrls(){\n      if(this.movie.length==0){ \n        return null;   //页面刷新时返回null\n      }else{\n        return  `http://127.0.0.1:5050/${this.movie[this.i].pic}`\n      }\n    },\n    //ul的宽度\n    cid(){ return this.$store.state.cid;  },  //获取cid\n    mid(){ return this.$store.state.mid;  }  , //获取mid\n    // mname(){ return this.$store.state.mname; }   //获取mid\n  },\n  created(){\n    //调用axios函数\n    console.log(this.$route.path)\n    console.log(window.location.href)\n    this.loadCinema();\n    this.isLogin();\n  },\n  mounted(){      \n    this.loadMore();   \n    this.wait();\n  },\n  methods:{\n    //跳转到seat.vue\n    goSeat(e){\n      var cmid=e.currentTarget.dataset.cmid;\n      var uid=this.$store.getters.getUid;\n      //1 如果登录了，跳转到seat.vue\n      if(uid!=\"\"){\n        this.$store.commit(\"changeCmid\",cmid);\n        this.$router.push(`/seat`);\n      }else{\n        //2 如果没登录,先登录，在跳转\n        this.$messagebox.confirm(\"是否立即登录\")\n        .then(action=>{\n          this.$router.push('/login')\n        })\n        .catch(err=>{return;})\n      }\n    },\n    //1 跳转到登录页，保存住当前页面的地址\n    toLogin(){\n      this.$router.push(\"/login\")\n    },\n    //2 判断是否登录\n    isLogin(){\n      var url=\"user/v1/isLogin\";\n      this.axios.get(url).then(res=>{\n        if(res.data.code==-1){\n          console.log(res.data.msg);\n        }else{\n          //登录成功，保存住uname;\n          console.log(\"打印用户登录信息\",res.data.data[0]);\n          this.uname=res.data.data[0].uname;\n        }\n      })\n    },\n    //获取今天的时间和明天的时间\n    getDay(num){\n      var d2=new Date();\n      d2=d2.getTime();\n      d2+=num*24*60*60*1000;\n      //以d2毫秒数为基础\n      var d1=new Date(d2);\n      var month=d1.getMonth();\n      month= (month>=9) ? month+1 : (\"0\"+(month+1))\n      var date=d1.getDate();\n      date=(date>=10) ? date : ('0'+date);\n      return month+\"-\"+date;\n    },\n    //1 动态计算那部电影会居中显示\n    showI(){\n      for(var i=0;i<this.movie.length;i++){\n        if(this.movie[i].mid==this.mid){\n          this.iTem=i;  //获取真实的mid对应的下标\n          return;\n        }\n      }      \n    },\n    //页面刷新，等待500执行\n    wait(){\n      setTimeout(()=>{\n        this.i=this.iTem;\n        setTimeout(()=>{\n          this.iCenter();          \n        },100)\n\n      },300)\n    },\n    //i位置的图片居中函数\n    iCenter(){\n      var ml=-window.innerWidth*0.22*(this.i)+window.innerWidth*0.39;\n      this.marginLeft=ml; \n      var wiw=this.wiw;\n      var imgBlock=document.getElementsByClassName(\"activeImg\")[0]\n      imgBlock.style.width=20.9*wiw*0.01+'px';\n      imgBlock.style.height=28.8*wiw*0.01+'px';\n      imgBlock.style.left='2.5%';\n    },\n    //切割字符串的icon的函数\n    strSplit(str){\n      var arr=str.split(\"，\");\n      // console.log(arr)\n      return arr;\n    },\n    //点击图片时移动,改变i值和margin-left值\n    changeI(e){\n      var i=e.target.dataset.index;\n      var ml=-window.innerWidth*0.22*i+window.innerWidth*0.39;\n      this.i=i;\n      this.marginLeft=ml;\n      var wiw=this.wiw;\n      //设置定时器，在i值改变时，50ms后准确的捕捉到元素   \n      setTimeout(()=>{     \n        var imgBlockNo=document.getElementsByClassName(\"noActive\");\n        // console.log(imgBlockNo)\n        for(var item of imgBlockNo){\n          item.style.width=17.6*wiw*0.01+'px';;\n          item.style.height=24.3*wiw*0.01+'px';;\n          item.style.left='10%';\n        }     \n        //使点击的图片居中\n        var imgBlock=e.target.parentNode;\n        // var imgBlock=document.getElementsByClassName(\"activeImg\")[0]\n        imgBlock.style.width=20.9*wiw*0.01+'px';\n        imgBlock.style.height=28.8*wiw*0.01+'px';\n        imgBlock.style.left=\"2.5%\";\n        //使其他图片归位\n      },50)\n    },\n    //鼠标松开时，使下标i的图片居中\n    ontouchend(){\n      this.iCenter();\n      // var ml=-window.innerWidth*0.22*(this.i)+window.innerWidth*0.39;\n      // this.marginLeft=ml; \n      // var wiw=this.wiw;\n      // var imgBlock=document.getElementsByClassName(\"activeImg\")[0]\n      // imgBlock.style.width=20.9*wiw*0.01+'px';\n      // imgBlock.style.height=28.8*wiw*0.01+'px';\n      // imgBlock.style.left='2.5%';\n    },\n    //点击时保存鼠标初始位置，和ul的起始位置\n    ontouchstart(e){\n      var t1 = e.targetTouches[0];\n      this.xStart=t1.pageX;   \n      this.mlStart=this.marginLeft;  \n    },\n    //鼠标移动时，改变ul的margin-left;\n    ontouchmove(e){\n      var t2 = e.targetTouches[0];\n      var xMove=t2.pageX;                 //鼠标移动后的位置\n      var move=xMove-this.xStart;         //鼠标移动的距离=ul移动的距离        ;\n      var marginLeft=this.mlStart+move;\n      //1 防止到最右边和最左边\n      var widthMin=window.innerWidth*0.39;\n      if(marginLeft>=widthMin){\n        marginLeft=widthMin;\n      }\n      var widthMax=window.innerWidth*0.39-window.innerWidth*0.22*(this.movie.length-1)\n      if(marginLeft<=widthMax){\n        marginLeft=widthMax;\n      }\n      this.marginLeft=marginLeft;      \n    },\n    //ajax函数   参数cid\n    loadMore(){ \n      var url=\"cinema/v1/cinema_hasmovies\";\n      var obj={cid:this.cid};\n      this.axios.get(url,{params:obj}).then(res=>{\n        if(res.data.code==1){\n          console.log(res.data.data)\n          this.movie=res.data.data.infors;\n          this.time=res.data.data.times;\n          //后台传回mid\n          // var mid=this.$store.getMid();\n          // console.log(this.mname);\n          console.log(this.movie);\n          this.showI();\n          this.ulWidth=this.movie.length*window.innerWidth*0.22+'px'\n          // console.log(\"axios查询成功\")\n        }else{\n          console.log(\"axios查询失败1\")\n        }\n      })\n    },\n    loadCinema(){ \n      var url=\"cinema/v1/cinema_detail\";\n      var obj={cid:this.cid};\n      this.axios.get(url,{params:obj}).then(res=>{\n        if(res.data.code==1){\n          console.log(res.data.data[0])\n          this.cinema=res.data.data[0];\n          this.tag=this.strSplit(this.cinema.tag);\n          // console.log(\"axios查询成功\")\n        }else{\n          console.log(\"axios查询失败2\")\n        }\n      })\n    },\n  }\n}\n</script>\n<style>\n    @import url('../../assets/css/findCinemaItem.css');\n    @import url('../../assets/css/cinema.css')\n</style>\n"]}]}