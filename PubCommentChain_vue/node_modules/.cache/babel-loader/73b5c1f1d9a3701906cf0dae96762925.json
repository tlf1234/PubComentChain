{"remainingRequest":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\babel-loader\\lib\\index.js!D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pubComentsChain\\PubCommentChain_vue\\src\\views\\login\\Login.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\src\\views\\login\\Login.vue","mtime":1569206673000},{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645264055207},{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1529635966000},{"path":"D:\\pubComentsChain\\PubCommentChain_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  data: function data() {\n    return {\n      imgurl: \"http://127.0.0.1:5050/01.png\",\n      unameholder: \"请输入您的手机号\",\n      upwdholder: \"请输入您的密码\",\n      uphone: \"\",\n      upwd: \"\"\n    };\n  },\n  // 使用路由钩子在页面里获取跳转过来的路径\n  beforeRouteEnter: function beforeRouteEnter(to, from, next) {\n    next(function (vm) {\n      console.log(\"打印出从哪个页面跳转过来\", from.fullPath); //判断，是否为 /reguser false，将其保存\n\n      if (from.path != \"/reguser\") {\n        vm.$store.commit(\"changeToLoginPath\", from.fullPath);\n      }\n\n      next(); //允许跳转      \n    });\n  },\n  computed: {\n    toLoginPath: function toLoginPath() {\n      return this.$store.state.toLoginPath;\n    },\n    //获取从哪个页面跳转到登录页面\n    cid: function cid() {\n      return this.$store.state.cid;\n    },\n    mid: function mid() {\n      return this.$store.state.mid;\n    }\n  },\n  methods: {\n    login: function login() {\n      var _this = this;\n\n      //完成用户登录操作\n      //1：获取用户输入号码\n      var u = this.uphone; //2：获取用户输入密码\n\n      var p = this.upwd; // console.log(u+\":\"+p)测试\n      //3:创建正则表达式验证用户名和密码\n\n      var ureg = /^1[3-9][0-9]{9}$/;\n      var preg = /^\\w{6}$/; // 4：用户名验证失败，提示短消息\n\n      if (!ureg.test(u)) {\n        this.$toast(\"用户名格式不正确\");\n        return;\n      } // 5：密码验证失败，提示短消息\n\n\n      if (!preg.test(p)) {\n        this.$toast(\"密码格式不正确\");\n        return;\n      } // 6：发送ajax请求 axios\n\n\n      var url = \"user/v1/login\";\n      var obj = {\n        uphone: u,\n        upwd: p\n      };\n      this.axios.get(url, {\n        params: obj\n      }).then(function (res) {\n        // 7：获取服务器返回结果\n        // console.log(res);\n        // 7.1登录失败  提示  17816899467\n        if (res.data.code == -1) {\n          console.log(1);\n\n          _this.$toast(\"用户名或密码错误\");\n        } else {\n          //登录成功，先保存一下uid;\n          _this.$store.commit(\"changeUid\", res.data.data); //登录时，在这里进行判断  /  /findCinema  /cinema 一共三种情况\n\n\n          var path = _this.$store.getters.getToLoginPath; //1 /\n\n          if (path == \"/\") {\n            //  先设置主页面的active=movie  跳转到首页组件\n            // window.history.go(0); 该方法不可用，\n            //刷新页面，会清除掉前面改变过得vuex \n            _this.$store.commit(\"changeActive\", 'movie'); // this.$router.push(\"/\")     \n\n\n            _this.$router.go(-1);\n          } else {\n            // this.$router.push(path);\n            _this.$router.go(-1); //不会刷新页面，返回history上一页\n            // location.replace(path);   //跳转时，会刷新页面，导致vuex数据丢失\n\n          }\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAqBA,eAAA;AACA,MADA,kBACA;AACA,WAAA;AACA,cAAA,8BADA;AAEA,mBAAA,UAFA;AAGA,kBAAA,SAHA;AAIA,cAAA,EAJA;AAKA,YAAA;AALA,KAAA;AAOA,GATA;AAUA;AACA,kBAXA,4BAWA,EAXA,EAWA,IAXA,EAWA,IAXA,EAWA;AACA,SAAA,cAAA;AACA,cAAA,GAAA,CAAA,cAAA,EAAA,KAAA,QAAA,EADA,CAEA;;AACA,UAAA,KAAA,IAAA,IAAA,UAAA,EAAA;AACA,WAAA,MAAA,CAAA,MAAA,CAAA,mBAAA,EAAA,KAAA,QAAA;AACA;;AACA,aANA,CAMA;AACA,KAPA;AAQA,GApBA;AAqBA,YAAA;AACA,eADA,yBACA;AAAA,aAAA,KAAA,MAAA,CAAA,KAAA,CAAA,WAAA;AAAA,KADA;AACA;AACA,OAFA,iBAEA;AAAA,aAAA,KAAA,MAAA,CAAA,KAAA,CAAA,GAAA;AAAA,KAFA;AAGA,OAHA,iBAGA;AAAA,aAAA,KAAA,MAAA,CAAA,KAAA,CAAA,GAAA;AAAA;AAHA,GArBA;AA0BA,WAAA;AACA,SADA,mBACA;AAAA;;AACA;AACA;AACA,UAAA,IAAA,KAAA,MAAA,CAHA,CAIA;;AACA,UAAA,IAAA,KAAA,IAAA,CALA,CAMA;AACA;;AACA,UAAA,OAAA,kBAAA;AACA,UAAA,OAAA,SAAA,CATA,CAUA;;AACA,UAAA,CAAA,KAAA,IAAA,CAAA,CAAA,CAAA,EAAA;AACA,aAAA,MAAA,CAAA,UAAA;AACA;AACA,OAdA,CAeA;;;AACA,UAAA,CAAA,KAAA,IAAA,CAAA,CAAA,CAAA,EAAA;AACA,aAAA,MAAA,CAAA,SAAA;AACA;AACA,OAnBA,CAoBA;;;AACA,UAAA,MAAA,eAAA;AACA,UAAA,MAAA;AAAA,gBAAA,CAAA;AAAA,cAAA;AAAA,OAAA;AACA,WAAA,KAAA,CAAA,GAAA,CAAA,GAAA,EAAA;AAAA,gBAAA;AAAA,OAAA,EAAA,IAAA,CAAA,eAAA;AACA;AACA;AACA;AACA,YAAA,IAAA,IAAA,CAAA,IAAA,IAAA,CAAA,CAAA,EAAA;AACA,kBAAA,GAAA,CAAA,CAAA;;AACA,gBAAA,MAAA,CAAA,UAAA;AACA,SAHA,MAGA;AACA;AACA,gBAAA,MAAA,CAAA,MAAA,CAAA,WAAA,EAAA,IAAA,IAAA,CAAA,IAAA,EAFA,CAGA;;;AACA,cAAA,OAAA,MAAA,MAAA,CAAA,OAAA,CAAA,cAAA,CAJA,CAKA;;AACA,cAAA,QAAA,GAAA,EAAA;AACA;AACA;AACA;AACA,kBAAA,MAAA,CAAA,MAAA,CAAA,cAAA,EAAA,OAAA,EAJA,CAKA;;;AACA,kBAAA,OAAA,CAAA,EAAA,CAAA,CAAA,CAAA;AACA,WAPA,MAOA;AACA;AACA,kBAAA,OAAA,CAAA,EAAA,CAAA,CAAA,CAAA,EAFA,CAEA;AACA;;AAEA;AACA;AACA,OA3BA;AA6BA;AArDA;AA1BA,CAAA","sourcesContent":["<template>\n    <div class=\"app-login\">\n        <!-- 1：头像 -->\n        <div class=\"imgstyle\">\n            <img :src=\"imgurl\" >\n        </div>\n        <div class=\"am-list\">\n            <!-- 2：用户名输入框（手机号）  -->\n            <mt-field :placeholder=\"unameholder\" v-model=\"uphone\" class=\"am-list-item\"></mt-field>\n            <!-- 3：密码输入框 -->\n            <mt-field :placeholder=\"upwdholder\" v-model=\"upwd\" class=\"am-list-item\"></mt-field>\n            <!-- 4：登录按钮 -->\n            <div class=\"btnstyle\">\n                <mt-button @click=\"login\">登 录</mt-button>\n            </div>\n            <!-- 5:免费注册 -->\n            <router-link to=\"/reguser\" class=\"fontstyle\">没有账号?免费注册</router-link>\n        </div>\n    </div>\n</template>\n<script>\nexport default {\n    data() {\n        return {\n            imgurl:\"http://127.0.0.1:5050/01.png\",\n            unameholder:\"请输入您的手机号\",\n            upwdholder:\"请输入您的密码\",\n            uphone:\"\",\n            upwd:\"\"\n        }\n    },\n    // 使用路由钩子在页面里获取跳转过来的路径\n    beforeRouteEnter (to, from, next) {\n        next(vm=>{\n            console.log(\"打印出从哪个页面跳转过来\",from.fullPath);\n            //判断，是否为 /reguser false，将其保存\n            if(from.path!=\"/reguser\"){\n                vm.$store.commit(\"changeToLoginPath\",from.fullPath)\n            }\n            next();  //允许跳转      \n        })\n    },\n    computed:{\n        toLoginPath(){ return this.$store.state.toLoginPath;},  //获取从哪个页面跳转到登录页面\n        cid(){return this.$store.state.cid; },\n        mid(){return this.$store.state.mid; },\n    },\n    methods:{\n        login(){\n            //完成用户登录操作\n            //1：获取用户输入号码\n            var u=this.uphone;\n            //2：获取用户输入密码\n            var p=this.upwd;\n            // console.log(u+\":\"+p)测试\n            //3:创建正则表达式验证用户名和密码\n            var ureg=/^1[3-9][0-9]{9}$/;\n            var preg=/^\\w{6}$/;\n            // 4：用户名验证失败，提示短消息\n            if(!ureg.test(u)){\n                this.$toast(\"用户名格式不正确\");\n                return;\n            }\n            // 5：密码验证失败，提示短消息\n            if(!preg.test(p)){\n                this.$toast(\"密码格式不正确\");\n                return;\n            }\n            // 6：发送ajax请求 axios\n            var url=\"user/v1/login\";\n            var obj={uphone:u,upwd:p}\n            this.axios.get(url,{params:obj}).then(res=>{\n                // 7：获取服务器返回结果\n                // console.log(res);\n                // 7.1登录失败  提示  17816899467\n                if(res.data.code==-1){\n                    console.log(1);\n                    this.$toast(\"用户名或密码错误\")\n                }else{\n                    //登录成功，先保存一下uid;\n                    this.$store.commit(\"changeUid\",res.data.data);\n                    //登录时，在这里进行判断  /  /findCinema  /cinema 一共三种情况\n                        var path=this.$store.getters.getToLoginPath;\n                        //1 /\n                        if(path==\"/\"){\n                            //  先设置主页面的active=movie  跳转到首页组件\n                            // window.history.go(0); 该方法不可用，\n                            //刷新页面，会清除掉前面改变过得vuex \n                            this.$store.commit(\"changeActive\",'movie');  \n                            // this.$router.push(\"/\")     \n                            this.$router.go(-1);\n                        }else{\n                            // this.$router.push(path);\n                            this.$router.go(-1);         //不会刷新页面，返回history上一页\n                            // location.replace(path);   //跳转时，会刷新页面，导致vuex数据丢失\n\n                        }\n                    }\n                }\n            )\n        }\n    }\n}\n</script>\n<style scoped>\n    /* 图片样式 */\n    .imgstyle{\n        width:5rem;height: 5rem;\n        margin: 3rem auto;\n    }\n    .imgstyle>img{border-radius: 5rem}\n    /* 输入框样式 */\n    .am-list-item{\n        width:20rem;\n        border: 0;\n        border-bottom: 1px solid #ff2e62;\n        margin: 1.8rem auto;\n        font-size: .1rem;\n    }\n    /* 按钮样式 */\n    .btnstyle{\n        width:20rem; height: 2.8rem;\n        margin: 2rem auto;\n        margin-bottom: 1rem;\n    }\n    .btnstyle>button{\n        width: 100%;height: 100%;\n        background: linear-gradient(45deg,#ff47a8,#ff2e62);\n        border-radius: 2rem;\n        font-size: 1.1rem;\n        color: #ffffff;\n    }\n    /* 注册文字样式 */\n    .fontstyle{\n        display: inline-block;\n        width: 20rem;\n        font-size:.8rem;\n        text-align: center;\n        color: #333333;\n    }\n</style>"],"sourceRoot":"src\\views\\login"}]}