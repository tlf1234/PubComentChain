{"remainingRequest":"D:\\HackSon\\tpp-master\\tpp_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\HackSon\\tpp-master\\tpp_vue\\src\\views\\seat\\Seat.vue?vue&type=style&index=0&lang=css","dependencies":[{"path":"D:\\HackSon\\tpp-master\\tpp_vue\\src\\views\\seat\\Seat.vue","mtime":1569206673000},{"path":"D:\\HackSon\\tpp-master\\tpp_vue\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\HackSon\\tpp-master\\tpp_vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1521907989000},{"path":"D:\\HackSon\\tpp-master\\tpp_vue\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\HackSon\\tpp-master\\tpp_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645264055207},{"path":"D:\\HackSon\\tpp-master\\tpp_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import url(\"../../assets/css/seat.css\");\n",{"version":3,"sources":["Seat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyLA","file":"Seat.vue","sourceRoot":"src\\views\\seat","sourcesContent":["<template>\n  <div class=\"root\" id=\"seat\">\n    <div class=\"content\">\n      <div class=\"dy-list-item\">\n        <div class=\"cinema-info\">\n          <div class=\"dy-list-title\" v-cloak>{{detail.cname}}</div>\n          <div class=\"dy-list-brief\" v-cloak>今天 {{detail.time_start}}~{{detail.time_end}} ({{detail.d23}})</div>\n        </div>\n      </div>\n      <div id=\"J_xseat\">\n        <div class=\"seat-legend\">\n          <ul>\n            <li>\n              <i class=\"tpp-i i-normal core\"></i>可选\n            </li>\n            <li>\n              <i class=\"tpp-i i-sold core\"></i>已售\n            </li>\n            <li>\n              <i class=\"tpp-i i-best-area\"></i>最佳观影区\n            </li>\n          </ul>\n        </div>\n        <div class=\"hall-name\">\n          <p class=\"i-screen\">彩虹厅 银幕</p>\n        </div>\n      </div>\n      <div></div>\n    </div>\n    <div class=\"list_bg\">\n      <div class=\"seat_list\" @click=\"choose\">\n        <div class=\"row\" v-for=\"(item,index) of list\" :key=\"index\">\n          <div class=\"col\" v-for=\"(elem,index2) of item\" :key=\"index2\">\n            <!-- show==0 代表座位已经出售，显示为红色   -->\n            <span :data-j=\"elem.j\" :data-i=\"elem.i\" :data-show=\"elem.show\" :data-choose=\"elem.choose\" :class=\"{'is_show':elem.show==0,green:elem.choose==1}\"></span>          \n          </div>\n        </div>\n      </div>     \n    </div>\n    <div class=\"choose_main\">\n      <ul>\n        <li class=\"choose_item\" v-for=\"(elem,i) of buyList\" :data-j=\"elem.j\" :data-i=\"elem.i\" :key=\"i\" @click=\"del\">\n          <h3>{{elem.j+1}}排{{elem.i+1}}座</h3>\n          <h4>72.7元</h4>\n        </li>        \n      </ul>\n    </div>\n    <div class=\"jus\" :class=\"{show:buyList.length>0}\" @click=\"toPayment\">\n      <span class=\"tpp-btn\">请选座位</span>\n    </div>\n  </div>\n</template>\n<script>\nexport default {\n  data(){\n    return {\n      num:0,\n      detail:[],     //保存了这部电影时间价格影院\n      cname:'',\n      id:[1,3,4,6],\n      list:[],      //座位列表  这种形式  [ {i:7,j:3},{i:7,j:4} ]   全部的座位列表\n      soldList:[ {i:8,j:5},{i:8,j:3},{i:8,j:4},{i:6,j:5},{i:7,j:3},{i:7,j:4} ],  //已售位置\n    }\n  },\n  created(){\n    this.load();\n    this.createList();\n  },\n  computed:{   \n    cmid(){\n      return this.$store.state.cmid;\n    },\n    //使用计算属性，计算出一个数组，里面包含了，choose==1的对象，可以（强行监听数组 list=[] 的变化）\n    buyList(){  \n      var list=[];\n      for(var j=0;j<this.list.length;j++){\n        for(var i=0;i<this.list[j].length;i++){\n          if(this.list[j][i].choose==1){\n            list[list.length]=this.list[j][i];\n          }\n        }\n      }\n      return list;\n    },\n  },  \n  methods:{\n    toPayment(){\n      if(this.buyList.length>0){\n          // 路由传参对象，接受页面一刷新，数据就会变为\n          // {buyList: Array(4), detail: \"[object Object]\", cname: \"[object Object]\"}\n          var obj={buyList:this.buyList,detail:this.detail,cname:this.cname}\n          // console.log(obj);\n          // this.$router.push({\n          //   path:\"/payment\",\n          //   query:obj\n          // })      \n        //  vuex\n        this.$store.commit(\"changeSeatObj\",obj);\n        this.$router.push('/payment')\n      }else{\n        this.$toast({\n          message:\"请先选择座位\",\n          duration:1000\n        })\n      }\n\n    },\n    //删除位置\n    del(e){ \n      // console.log(e.currentTarget);\n      var el=e.currentTarget;\n      var j=el.dataset.j;\n      var i=el.dataset.i;\n      //找到对应的元素 删除      \n      this.list[j][i].choose=0;\n      this.num--;\n    },\n    //选座位\n    choose(e){\n      var el=e.target;\n      if(el.nodeName==\"SPAN\"){ \n        var s=el.dataset.show;\n        if(this.num>=6){\n          this.$toast({\n            message:\"最多可选6个座位\",\n            duration:1000\n          })\n          return;\n        }\n        if(s!=0){         //在s!=0 是操作\n          // var list=this.list;\n          var j=el.dataset.j;\n          var i=el.dataset.i;      \n          if(el.dataset.choose==0){   //没有选中，让其选中\n            this.list[j][i].choose=1;  \n            this.num++;   \n          }else{                           //否则让其不选中\n            this.list[j][i].choose=0;\n            this.num--;\n          }      \n        }\n      } \n    },\n    //创建座位list，\n    createList(){\n      var soldList=this.soldList;\n      var list = [];\n      for(var a=0;a<9;a++){\n        var li=[]\n        for(var b=0;b<14;b++){\n          var num=0;\n          for(var z=0;z<soldList.length;z++){\n            if((soldList[z].i==b) && (soldList[z].j==a)){\n              num++;\n            }\n          }\n          if(num>0){\n            var obj={i:b,j:a,show:0,choose:0}  //show:0 位置出售    \n          }else{\n            var obj={i:b,j:a,show:1,choose:0}  //show:1 位置未出售\n          }\n          li[b]=obj;\n        }\n        list[a]=li;\n      }\n      this.list=list;\n    },\n    //load\n    load(){\n      var url=\"cinema/v1/seat\"\n      var cmid=this.cmid;\n      var obj={cmid};\n      this.axios.get(url,{params:obj}).then(res=>{\n        if(res.data.code==0){\n          console.log(res.data.msg)\n        }else{\n          this.detail=res.data.data.detail;\n          this.cname=res.data.data.cname;\n        }\n      })\n    },\n  }\n}\n</script>\n<style>\n    @import url(\"../../assets/css/seat.css\");\n</style>"]}]}